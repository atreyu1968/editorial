<!DOCTYPE html>
<html lang="gn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atreyu Servicios Digitales - Tembipuru Guasu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; letter-spacing: -0.02em; }
        .animate-fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-[#f8fafc]">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Tembipuru ta'anga rehegua
        const Icon = ({ name, ...props }) => {
            const LucideIcon = lucide[name];
            return LucideIcon ? <LucideIcon {...props} /> : null;
        };

        const API_BASE = "/api";

        const App = () => {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [token, setToken] = useState(localStorage.getItem('atreyu_token'));
            const [activeTab, setActiveTab] = useState('dashboard');
            const [data, setData] = useState({ authors: [], series: [], books: [], tasks: [], metrics: [] });
            const [loading, setLoading] = useState(false);
            const [currentDate, setCurrentDate] = useState(new Date());

            useEffect(() => {
                if (token) {
                    setIsAuthenticated(true);
                    refreshData();
                }
            }, [token]);

            const refreshData = async () => {
                setLoading(true);
                try {
                    const res = await fetch(`${API_BASE}/data`, {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    const json = await res.json();
                    setData(json);
                } catch (e) {
                    setIsAuthenticated(false);
                } finally {
                    setLoading(false);
                }
            };

            const handleLogin = async (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                const res = await fetch(`${API_BASE}/login`, { method: 'POST', body: formData });
                if (res.ok) {
                    const result = await res.json();
                    localStorage.setItem('atreyu_token', result.token);
                    setToken(result.token);
                    setIsAuthenticated(true);
                } else {
                    alert("Ñe'ẽmimi ndoikói");
                }
            };

            if (!isAuthenticated) {
                return (
                    <div className="min-h-screen bg-[#0f172a] flex items-center justify-center p-6">
                        <div className="bg-white w-full max-w-md rounded-[56px] p-12 shadow-2xl animate-fade-in text-center">
                            <div className="w-24 h-24 bg-slate-50 rounded-[36px] mx-auto mb-6 shadow-inner overflow-hidden flex items-center justify-center border border-slate-100">
                                <img src="/static/ASD.png" alt="ASD" className="w-full h-full object-contain p-2" onerror="this.src='https://via.placeholder.com/150?text=ASD'"/>
                            </div>
                            <h2 className="text-3xl font-black text-slate-800 tracking-tighter uppercase italic text-blue-600 leading-none">ATREYU</h2>
                            <p className="text-slate-400 font-bold text-[9px] uppercase tracking-[0.3em] mt-2 mb-10">Keikeha Mohendaha</p>
                            
                            <form onSubmit={handleLogin} className="space-y-4 text-left">
                                <div className="relative">
                                    <Icon name="Key" className="absolute left-5 top-1/2 -translate-y-1/2 text-slate-300" size={18} />
                                    <input name="password" type="password" placeholder="Emoĩ ne ñe'ẽmimi" required 
                                           class="w-full pl-14 pr-6 py-5 bg-slate-50 border border-slate-200 rounded-[24px] font-bold text-sm focus:border-blue-500 outline-none transition-all" />
                                </div>
                                <button type="submit" class="w-full py-5 bg-slate-900 text-white font-black rounded-[24px] uppercase tracking-widest text-[10px] shadow-2xl hover:bg-blue-600 transition-all">Eike haguã</button>
                            </form>
                            <p className="mt-12 text-[8px] font-bold text-slate-300 uppercase tracking-widest italic">© 2026 Atreyu Servicios Digitales</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen flex text-slate-800">
                    {/* SIDEBAR ASD */}
                    <aside className="w-72 bg-slate-900 text-white flex flex-col border-r border-slate-800 shrink-0">
                        <div className="p-10 flex flex-col items-center border-b border-slate-800/50">
                            <div className="w-14 h-14 bg-white rounded-2xl mb-4 flex items-center justify-center p-2 shadow-lg border border-slate-700">
                                <img src="/static/ASD.png" alt="Logo" class="w-full h-full object-contain" />
                            </div>
                            <h1 className="text-lg font-black italic uppercase tracking-tighter leading-none">ATREYU</h1>
                            <p className="text-[8px] font-black text-blue-400 uppercase tracking-[0.2em] mt-1">Editorial Hub</p>
                        </div>
                        <nav className="flex-1 px-6 py-8 space-y-1 overflow-y-auto">
                            {[
                                { id: 'dashboard', label: 'Ñemongu\'e', icon: 'LayoutDashboard' },
                                { id: 'library', label: 'Aranduka Renda', icon: 'BookOpen' },
                                { id: 'authors', label: 'Haihára', icon: 'User' },
                                { id: 'series', label: 'Aranduka Aty', icon: 'Library' },
                                { id: 'calendar', label: 'Arapapaha', icon: 'Calendar' },
                                { id: 'analytics', label: 'Viru Puru', icon: 'BarChart3' }
                            ].map(item => (
                                <button key={item.id} onClick={() => setActiveTab(item.id)} 
                                        class={`w-full flex items-center gap-4 px-6 py-4 rounded-[20px] transition-all font-black text-[10px] uppercase tracking-widest ${activeTab === item.id ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-500 hover:text-white'}`}>
                                    <Icon name={item.icon} size={16} />
                                    {item.label}
                                </button>
                            ))}
                        </nav>
                        <div className="p-8 mt-auto flex flex-col gap-4">
                            <div className="flex items-center justify-center gap-2 py-2 opacity-40">
                                <img src="/static/ASD.png" alt="ASD" class="h-3 w-auto grayscale brightness-200" />
                                <p class="text-[8px] font-black text-slate-500 uppercase tracking-tighter italic">© 2026 Atreyu S.D.</p>
                            </div>
                        </div>
                    </aside>

                    {/* MAIN CONTENT */}
                    <main className="flex-1 flex flex-col overflow-hidden bg-[#f8fafc]">
                        <header className="h-20 bg-white border-b border-slate-200 flex items-center justify-between px-12 shrink-0">
                            <div className="flex items-center gap-4">
                                <h2 className="text-lg font-black uppercase italic tracking-tighter">{activeTab}</h2>
                                <div className="w-[1px] h-4 bg-slate-200"></div>
                                <p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest italic">Atreyu ASD</p>
                            </div>
                        </header>

                        <div className="flex-1 overflow-y-auto p-12">
                            <div className="animate-fade-in max-w-7xl mx-auto w-full">
                                {loading ? (
                                    <div className="text-center py-20 text-slate-300 font-black uppercase tracking-widest text-xs">Rogueru hína marandukuéra...</div>
                                ) : (
                                    <div className="flex flex-col items-center justify-center h-full min-h-[400px] border-4 border-dashed border-slate-200 rounded-[64px] text-slate-200">
                                        <Icon name="Database" size={80} className="mb-6 opacity-10" />
                                        <p className="font-black text-2xl uppercase tracking-widest opacity-20 italic">Tenda Ñemongu'e Atreyu</p>
                                        <p className="text-[10px] font-bold mt-2 tracking-widest uppercase opacity-20">Ejeporeka haguã eipyru pe menú akatúa gotyogua</p>
                                    </div>
                                )}
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>